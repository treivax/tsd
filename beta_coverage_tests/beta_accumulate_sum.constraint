// Test Beta Join - SUM simulation (simplified)
type Sale : <id: string, customer_id: string, amount: number, region: string>
type Customer : <id: string, name: string, status: string>

{c: Customer, s: Sale} / c.status == "premium" AND s.customer_id == c.id AND s.amount > 1000 ==> high_value_customer(c.id)
{c: Customer, s: Sale} / c.status == "regular" AND s.customer_id == c.id AND s.amount > 500 ==> upgrade_candidate(c.id)
