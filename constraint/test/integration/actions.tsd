// Test 6 : Actions et Jobs (TerminalNode)
// Types pour tests d'actions
type Alarm(#id: string, source: string, severity: string, message: string, timestamp: number)
type System(#id: string, name: string, status: string, cpu_usage: number, memory_usage: number)
type Incident(#id: string, system_id: string, type: string, priority: string, resolved: bool)

// Actions simples

// Actions auto-générées
action alert_team(arg1: string, arg2: string)
action backup_and_restart(arg1: string, arg2: string, arg3: string)
action compress_log(arg1: string)
action emergency_response(arg1: string)
action escalate(arg1: string, arg2: string)
action notify_admin(arg1: string, arg2: string)
action performance_tuning(arg1: string)
action restart_service(arg1: string)
action shutdownSys(arg1: string)
action throttle_processes(arg1: string)

rule r1 : {a: Alarm} / a.severity == "critical" ==> alert_team(a.id, a.source)

rule r2 : {s: System} / s.cpu_usage > 90 ==> restart_service(s.id)

rule r3 : {i: Incident} / i.priority == "high" AND i.resolved == false ==> escalate(i.id, i.system_id)

// Actions avec conditions complexes
rule r4 : {s: System, i: Incident} / s.id == i.system_id AND s.cpu_usage > 80 AND i.resolved == false ==> notify_admin(s.name, i.type)

// Actions avec agrégation
rule r5 : {s: System} / COUNT(a: Alarm / a.source == s.id) > 5 ==> shutdownSys(s.id)

// Actions avec négation
rule r6 : {s: System} / s.status == "running" AND NOT (s.cpu_usage < 10) ==> throttle_processes(s.id)

// Actions avec EXISTS
rule r7 : {s: System} / EXISTS (i: Incident / i.system_id == s.id AND i.priority == "critical") ==> emergency_response(s.id)

// Actions avec fonctions
rule r8 : {a: Alarm} / LENGTH(a.message) > 100 AND UPPER(a.severity) == "CRITICAL" ==> compress_log(a.id)

// Actions multiples arguments
rule r9 : {s: System, i: Incident} / s.id == i.system_id AND s.memory_usage > 95 ==> backup_and_restart(s.id, s.name, i.id)

// Actions avec expressions arithmétiques
rule r10 : {s: System} / s.cpu_usage + s.memory_usage > 150 ==> performance_tuning(s.id)
