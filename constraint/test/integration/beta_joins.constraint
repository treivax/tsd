// Test 2 : Jointures Beta (JoinNodeImpl)
// Types pour jointures multi-faits
type Customer : <id: string, name: string, age: number, vip: bool>
type Order : <id: string, customer_id: string, total: number, date: string>
type Product : <id: string, name: string, price: number, category: string>

// Jointures simples entre deux faits
{c: Customer, o: Order} / c.id == o.customer_id AND o.total > 500

{o: Order, p: Product} / o.total >= p.price * 2

{c: Customer, o: Order} / c.vip == true AND o.total > 1000 AND c.age >= 18

// Jointures complexes avec expressions arithmÃ©tiques
{c: Customer, o: Order} / c.age * 10 >= o.total / 100

{o: Order, p: Product} / (o.total - p.price) > p.price * 0.1

// Jointures avec fonctions
{c: Customer, o: Order} / LENGTH(c.name) > 5 AND UPPER(o.date) CONTAINS "2024"

{o: Order, p: Product} / ROUND(o.total) == CEIL(p.price * 1.2)

// Jointures avec conditions logiques complexes
{c: Customer, o: Order} / (c.vip == true OR c.age > 65) AND (o.total > 100 AND o.total < 50000)

{c: Customer, o: Order, p: Product} / c.id == o.customer_id AND o.total >= p.price AND c.vip == true