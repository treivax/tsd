// Test 2 : Jointures Beta (JoinNodeImpl)
// Types pour jointures multi-faits
type Customer : <id: string, name: string, age: number, vip: bool>
type Order : <id: string, customer_id: string, total: number, date: string>
type Product : <id: string, name: string, price: number, category: string>

// Jointures simples entre deux faits
{c: Customer, o: Order} / c.id == o.customer_id AND o.total > 500 ==> process_large_order(c.id, o.id)

{o: Order, p: Product} / o.total >= p.price * 2 ==> apply_bulk_discount(o.id, p.id)

{c: Customer, o: Order} / c.vip == true AND o.total > 1000 AND c.age >= 18 ==> apply_vip_benefits(c.id, o.id)

// Jointures complexes avec expressions arithmÃ©tiques
{c: Customer, o: Order} / c.age * 10 >= o.total / 100 ==> calculate_age_discount(c.id, o.id)

{o: Order, p: Product} / (o.total - p.price) > p.price * 0.1 ==> apply_margin_bonus(o.id, p.id)

// Jointures avec fonctions
{c: Customer, o: Order} / LENGTH(c.name) > 5 AND UPPER(o.date) CONTAINS "2024" ==> validate_customer_order(c.id, o.id)

{o: Order, p: Product} / ROUND(o.total) == CEIL(p.price * 1.2) ==> confirm_price_match(o.id, p.id)

// Jointures avec conditions logiques complexes
{c: Customer, o: Order} / (c.vip == true OR c.age > 65) AND (o.total > 100 AND o.total < 50000) ==> apply_special_offer(c.id, o.id)

{c: Customer, o: Order, p: Product} / c.id == o.customer_id AND o.total >= p.price AND c.vip == true ==> process_vip_transaction(c.id, o.id, p.id)